<!-- manual page source format generated by PolyglotMan v3.2, -->
<!-- available at http://polyglotman.sourceforge.net/ -->

<html>
<head>
<title>IM_FORMAT(3) manual page</title>
</head>
<body bgcolor='white'>
<a href='#toc'>Table of Contents</a><p>

<h2><a name='sect0' href='#toc0'>Name</a></h2>
im_format_register, im_format_set_priority, im_format_unregister, im_format_map,
im_format_for_file, im_format_for_name, im_format_write -  load and search
image formats 
<h2><a name='sect1' href='#toc1'>Synopsis</a></h2>
#include &lt;vips/vips.h&gt; 
<p> typedef enum { <br>
  IM_FORMAT_FLAG_NONE = 0,<br>
 <br>
  IM_FORMAT_FLAG_PARTIAL = 1<br>
 <br>
} im_format_flags; 
<p> typedef gboolean (*im_format_is_a_fn)( const char *
); <br>
typedef int (*im_format_header_fn)( const char *, IMAGE * ); <br>
typedef int (*im_format_load_fn)( const char *, IMAGE * ); <br>
typedef int (*im_format_save_fn)( IMAGE *, const char * ); <br>
typedef im_format_flags (*im_format_flags_fn)( const char * ); 
<p> typedef
struct im__format_t { <br>
  const char *name;<br>
 <br>
  const char *name_user;<br>
 <br>
  int priority;        <br>
 <br>
  const char **suffs; <br>
 <br>
  im_format_is_a_fn is_a;<br>
 <br>
  im_format_header_fn header;<br>
 <br>
  im_format_load_fn load;<br>
 <br>
  im_format_save_fn save;<br>
 <br>
  im_format_flags_fn flags;<br>
 <br>
} im_format_t; 
<p> im_format_t *im_format_register( <br>
  const char *name, const char *name_user, const char **suffs,<br>
 <br>
  im_format_is_a_fn is_a, im_format_header_fn header,<br>
 <br>
  im_format_load_fn load, im_format_save_fn save,<br>
 <br>
  im_format_flags_fn flags );<br>
 <br>
void im_format_set_priority( im_format_t *format, int priority ); <br>
void im_format_unregister( im_format_t *format ); 
<p> void *im_format_map(
VSListMap2Fn fn, void *a, void *b ); <br>
im_format_t *im_format_for_file( const char *filename ); <br>
im_format_t *im_format_for_name( const char *filename ); 
<p> int im_format_write(
IMAGE *im, const char *filename ); 
<p> int im_format_read( const char *filename,
IMAGE *out ); 
<p> 
<h2><a name='sect2' href='#toc2'>Description</a></h2>
These functions register and unregister image
formats, and search the table of  available image formats to find one suitable
for loading or saving a file. 
<p> <a href='im_open.3.html'><b>im_open(3)</a>
 </b> will do something similar, but
that returns a descriptor to the file rather than copying to a descriptor
you supply.  
<p> The two APIs are useful in different circumstances:  <a href='im_open.3.html'><b>im_open(3)</a>

</b> is good if you want to directly manipulate a file on disc, for example
with the paintbox functions. The format API is useful for controlling how
a image is unpacked, since you can specify a destination for the copy. 
<p>
<a href='im_format_register.3.html'><b>im_format_register(3)</b></a>
 registers an image format with vips. This might typically
be called during module load, see the documentation for GModule. 
<p> An image
format has a number of components: 
<p> <b>name</b> The internal name by which the
format should be known. For example, the  OpenEXR image format is known
within vips as "exr". You can identify formats by testing this field with
 <a href='strcmp.3.html'><b>strcmp(3)</a>
.</b> 
<p> <b>name_user</b> The name as it should be displayed to the user. It
can be internationalised. For example, in English, the "analyze" format
is shown as "Analyze 6.0". 
<p> <b>suffs</b> A NULL-terminated array of possible file-name
suffixes for this format. This list is used to filter filenames when they
are shown to the user, and to help select a format to sav a file as. For
example, the JPEG format has the suffixes: <b>{ ".jpg", ".jpeg", ".jpe", NULL
}</b> 
<p> <b>is_a</b> A function which tests whether a file is of the specified format.
This is useful if you can guess a file type from the first few bytes in
the file. If you leave this function NULL, vips will guess from the filename
suffix for you. 
<p> <b>header</b> Load only the image header, not any of the image
pixels. vips will call this first on <a href='im_open.3.html'><b>im_open(3)</b></a>
 and delay loading pixels
until asked. If you leave this NULL, vips will just use the  <b>load </b> function.

<p> <b>load</b> Load the image from the file into the IMAGE. You can leave this function
NULL if you only have a  <b>save</b> method implemented. 
<p> <b>save</b> Write from the IMAGE
to the file in this format. You can leave this function NULL if you only
have a lload method implemented. 
<p> <b>flags</b> A function which examines the file
and sets various flags to indicated properties of the image. The only flag
implemented at the moment is <b>IM_FORMAT_FLAG_PARTIAL</b> which may be set to
indicate that the file can be read lazily. 
<p> vips registers the format and
returns a pointer to the <b>im_format_t </b> it created. This may later be used
to unregister the format. 
<p> <a href='im_format_set_priority.3.html'><b>im_format_set_priority(3)</b></a>
 sets a priority for
the format. Priorities for formats default to zero: you mmay set a lower
or higher number to set where in the format table your format is positioned.
 
<p> <a href='im_format_unregister.3.html'><b>im_format_unregister(3)</b></a>
 removes a format from vips. It mmight typically
be called during module unload, see the documentation for GModule. 
<p> <a href='im_format_map.3.html'><b>im_format_map(3)</b></a>

maps a function over the list of loaded formats. See  <a href='im_slist_map.3.html'><b>im_slist_map(3)</a>
.</b> 
<p> <a href='im_format_for_file.3.html'><b>im_format_for_file(3)</b></a>

looks at a file on disc and selects the &rsquo;best&rsquo; format to use to load that
 file. If no suitable format is found, it returns NULL and sets an error
message. 
<p> <a href='im_format_for_name.3.html'><b>im_format_for_name(3)</b></a>
 looks at a filename and picks a format to
use to save that file based on the file extension. If no suitable format
is found, it returns NULL and sets an error message. 
<p> <a href='im_format_read.3.html'><b>im_format_read(3)</b></a>

is a convenience function which copies the image from the file into the
IMAGE.  error, it returns non-zero and sets an error message. 
<p> <a href='im_format_write.3.html'><b>im_format_write(3)</b></a>

is a convenience function which copies the image to the file in the appropriate
format. On error, it returns non-zero and sets an error message. 
<p> 
<h2><a name='sect3' href='#toc3'>Return Value</a></h2>
The
functions return 0 success and -1 on error. 
<h2><a name='sect4' href='#toc4'>See Also</a></h2>
<a href='im_tiff2vips.3.html'>im_tiff2vips(3)</a>
, <a href='im_open.3.html'>im_open(3)</a>
.

<h2><a name='sect5' href='#toc5'>Author</a></h2>
Jesper Friis and John Cupitt <p>

<hr><p>
<a name='toc'><b>Table of Contents</b></a><p>
<ul>
<li><a name='toc0' href='#sect0'>Name</a></li>
<li><a name='toc1' href='#sect1'>Synopsis</a></li>
<li><a name='toc2' href='#sect2'>Description</a></li>
<li><a name='toc3' href='#sect3'>Return Value</a></li>
<li><a name='toc4' href='#sect4'>See Also</a></li>
<li><a name='toc5' href='#sect5'>Author</a></li>
</ul>
</body>
</html>
